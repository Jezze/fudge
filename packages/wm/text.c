#include <abi.h>
#include <fudge.h>
#include "box.h"
#include "draw.h"
#include "text.h"

static const unsigned char letter_[] = {
    0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00
};

static const unsigned char letter0[] = {
    0x00, 0x01, 0x01, 0x01, 0x00,
    0x01, 0x00, 0x00, 0x00, 0x01,
    0x01, 0x00, 0x00, 0x01, 0x01,
    0x01, 0x00, 0x01, 0x00, 0x01,
    0x01, 0x01, 0x00, 0x00, 0x01,
    0x01, 0x00, 0x00, 0x00, 0x01,
    0x00, 0x01, 0x01, 0x01, 0x00
};

static const unsigned char letter1[] = {
    0x00, 0x00, 0x01, 0x00, 0x00,
    0x00, 0x01, 0x01, 0x00, 0x00,
    0x00, 0x00, 0x01, 0x00, 0x00,
    0x00, 0x00, 0x01, 0x00, 0x00,
    0x00, 0x00, 0x01, 0x00, 0x00,
    0x00, 0x00, 0x01, 0x00, 0x00,
    0x00, 0x01, 0x01, 0x01, 0x00
};

static const unsigned char letter2[] = {
    0x00, 0x01, 0x01, 0x01, 0x00,
    0x01, 0x00, 0x00, 0x00, 0x01,
    0x00, 0x00, 0x00, 0x00, 0x01,
    0x00, 0x00, 0x00, 0x01, 0x00,
    0x00, 0x00, 0x01, 0x00, 0x00,
    0x00, 0x01, 0x00, 0x00, 0x00,
    0x01, 0x01, 0x01, 0x01, 0x01
};

static const unsigned char letter3[] = {
    0x00, 0x01, 0x01, 0x01, 0x00,
    0x01, 0x00, 0x00, 0x00, 0x01,
    0x00, 0x00, 0x00, 0x00, 0x01,
    0x00, 0x00, 0x00, 0x01, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x01,
    0x01, 0x00, 0x00, 0x00, 0x01,
    0x00, 0x01, 0x01, 0x01, 0x00
};

struct glyph font[] = {
    {{0, 0, 5, 7}, '_', letter_},
    {{0, 0, 5, 7}, '0', letter0},
    {{7, 7, 5, 7}, '1', letter1},
    {{24, 7, 5, 7}, '2', letter2},
    {{0, 0, 5, 7}, '3', letter3}
};

/*
void backbuffer_blitglyph(struct glyph *glyph, unsigned char bgcolor, unsigned char fgcolor)
{

    unsigned int i;

    for (i = 0; i < glyph->size.w * glyph->size.h; i++)
    {

        if (glyph->buffer[i])
            backbuffer[i] = fgcolor;
         else
            backbuffer[i] = bgcolor;

    }

}
*/

struct glyph *glyph_find(char c)
{

    unsigned int i;

    for (i = 0; i < 5; i++)
    {

        if (font[i].c == c)
            return &font[i];

    }

    return 0;

}

/*
void glyph_draw(struct glyph *glyph)
{

    backbuffer_blitglyph(glyph, WM_COLOR_DARK, WM_COLOR_LIGHT);
    backbuffer_drawnormal(&glyph->size);

}
*/

void glyph_setsize(struct glyph *glyph, unsigned int x, unsigned int y, unsigned int w, unsigned int h)
{

    box_setsize(&glyph->size, x, y, w, h);

}

